# Windows基线加固

## 账号口令

| 检查项名称                    | 危险等级 | 配置方法                                                     |
| ----------------------------- | -------- | ------------------------------------------------------------ |
| 检查是否已启用密码复杂性要求  | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br>本地计算机策略\计算机配置\Windows设置\安全设置\帐户策略\密码策略<br>在右边窗格中找到“密码必须符合复杂性要求”，配置为“已启用” |
| 检查密码长度最小值            | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\帐户策略\密码策略<br/>在右边窗格中找到“密码长度最小值”，配置为不小于标准值8 |
| 检查是否已禁用来宾(Guest)帐户 | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\安全选项<br/>在右边窗格中找到“(帐户:)来宾帐户状态”，配置为“已禁用” |
| 检查帐户锁定阈值              | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\帐户策略\帐户锁定策略<br/>在右边窗格中找到“帐户锁定阈值”，配置为<br> `!=0 && <=10` |
| 检查已启用的本地用户的个数    | 低       | 打开命令提示符，运行命令“compmgmt.msc”打开计算机管理面板<br/>计算机管理(本地)\系统工具\本地用户和组\用户<br/>新建一个用户并启用它 |
| 检查密码最长使用期限          | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\帐户策略\密码策略<br/>在右边窗格中找到“密码最长存留期(使用期限)”，配置为 `!=-1 && <=90` |

## 认证授权

| 检查项名称                                 | 危险等级 | 配置方法                                                     |
| ------------------------------------------ | -------- | ------------------------------------------------------------ |
| 检查允许从网络访问此计算机的用户和组       | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\用户权限分配(用户权利指派)<br>在右边窗格中找到“从网络访问此计算机”，配置为配置为指定授权用户或组 |
| 检查允许本地登录的用户和组                 | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\用户权限分配(用户权利指派)<br/>在右边窗格中找到“(允许)在本地登录”，配置为配置为指定授权用户或组 |
| 检查“取得文件或其它对象的所有权”的帐户和组 | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\用户权限分配(用户权利指派)<br/>在右边窗格中找到“取得文件或其他对象的所有权”，配置为配置为仅含有“Administrators”用户组 |
| 检查可从远端关闭系统的帐户和组             | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\用户权限分配(用户权利指派)<br/>在右边窗格中找到“从远程系统强制关机”，配置为配置为仅含有“Administrators”用户组 |
| 检查可关闭系统的帐户和组                   | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\用户权限分配(用户权利指派)<br/>在右边窗格中找到“关闭系统”，配置为配置为仅含有“Administrators”用户组 |



## 日志审计

| 检查项名称                                     | 危险等级 | 配置方法                                                     |
| ---------------------------------------------- | -------- | ------------------------------------------------------------ |
| 检查“审核对象访问”级别                         | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\审核策略<br/>在右边窗格中找到“审核对象访问”，勾选“成功”和“失败” |
| 检查“审核目录服务访问”级别                     | 低       | 同上                                                         |
| 检查“审核登录事件”级别                         | 低       | 同上                                                         |
| 检查“审核系统事件”级别                         | 低       | 同上                                                         |
| 检查“审核特权使用”级别                         | 低       | 同上                                                         |
| 检查“审核进程跟踪”级别                         | 低       | 同上                                                         |
| 检查“审核帐户管理”级别                         | 低       | 同上                                                         |
| 检查“审核策略更改”级别                         | 低       | 同上                                                         |
| 检查“审核帐户登录事件”级别                     | 低       | 同上                                                         |
| 检查应用程序日志文件最大大小                   | 低       | 打开命令提示符，运行命令“eventvwr.msc”打开组策略编辑器<br/>事件查看器(\Windows日志)\应用程序(日志)”，右键点击“应用程序(日志)”，打开其属性对话框，切换到“常规”选项卡<br/>配置“日志文件最大大小”，为不小于标准值0x800000 |
| 检查应用程序日志文件达到最大大小时的动作的序号 | 低       | 打开命令提示符，运行命令“eventvwr.msc”打开组策略编辑器<br/>事件查看器(\Windows日志)\应用程序(日志)”，右键点击“应用程序(日志)”，打开其属性对话框，切换到“常规”选项卡<br/>配置配置“日志文件达到最大大小时”为“按需要改写(覆盖)事件” |



## 协议安全

| 检查项名称                                                   | 危险等级 | 配置方法                                                     |
| ------------------------------------------------------------ | -------- | :----------------------------------------------------------- |
| 检查远程桌面(RDP)服务端口                                    | 低       | 打开命令提示符，运行命令“regedit”打开注册表编辑器<br>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp<br>修改名称为“PortNumber”的数值的数据，使其不等于标准值 0xd3d |
| 检查是否已删除SNMP服务的默认public团体                       | 低       | 打开命令提示符，运行命令“services.msc”打开服务管理器<br>在右边窗格中找到名称为“SNMP Service”的服务(若未找到则表示未安装SNMP服务，即合规)<br>停止此服务，或打开其属性对话框，切换到“安全”选项卡，删除public团体，或修改其名字 |
| 检查处于SYN_RCVD 状态下的 TCP 连接阈值                       | 低       | 打开命令提示符，运行命令“regedit”打开注册表编辑器<br>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters<br>添加名称为“TcpMaxHalfOpen”、类型为DWORD、数据为标准值 0x01f4 (注意：标准值为16进制表示)的数值，若已存在则修改其数据。此数据的有效值为在64-ffff(16进制) |
| 检查TCP连接请求阈值                                          | 低       | 打开命令提示符，运行命令“regedit”打开注册表编辑器<br/>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters<br/>添加名称为“TcpMaxPortsExhausted”、类型为DWORD、数据为标准值 0x5 (注意：标准值为16进制表示)的数值，若已存在则修改其数据。此数据的有效值为在0-ffff(16进制) |
| 检查是否已启用SYN攻击保护                                    | 低       | 打开命令提示符，运行命令“regedit”打开注册表编辑器<br/>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters<br/>添加名称为“SynAttackProtect”、类型为DWORD、数据为标准值 0x1 (注意：标准值为16进制表示)的数值，若已存在则修改其数据。此数据的有效值为在0-1 |
| 检查取消尝试响应 SYN 请求之前要重新传输 SYN-ACK 的次数       | 低       | 打开命令提示符，运行命令“regedit”打开注册表编辑器<br/>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters<br/>添加名称为“TcpMaxConnectResponseRetransmissions”、类型为DWORD、数据为标准值 0x1 (注意：标准值为16进制表示)的数值，若已存在则修改其数据。此数据的有效值为在0-255 |
| 检查处于SYN_RCVD 状态下，且至少已经进行了一次重新传输的TCP连接阈值 | 低       | 打开命令提示符，运行命令“regedit”打开注册表编辑器<br/>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters<br/>添加名称为“TcpMaxHalfOpenRetried”、类型为DWORD、数据为标准值 0x1 (注意：标准值为16进制表示)的数值，若已存在则修改其数据。此数据的有效值为在50-ffff(16进制) |



## 其他安全

| 检查项名称                                        | 危险等级 | 配置方法                                                     |
| ------------------------------------------------- | -------- | ------------------------------------------------------------ |
| 检查Simple TCP/IP Services服务状态                | 高       | 打开命令提示符，运行命令“services.msc”打开服务管理器<br>停止显示名称为“Simple TCP/IP Services”或“简单 TCP/IP 服务”的服务 |
| 检查DHCP Client服务状态                           | 高       | 打开命令提示符，运行命令“services.msc”打开服务管理器<br/>停止显示名称为“DHCP Client”的服务 |
| 检查Message Queuing服务状态                       | 高       | 打开命令提示符，运行命令“services.msc”打开服务管理器<br/>停止显示名称为“Message Queuing”的服务 |
| 检查DHCP Server服务状态                           | 高       | 打开命令提示符，运行命令“services.msc”打开服务管理器<br/>停止显示名称为“DHCP Server”的服务 |
| 检查Windows Internet Name Service (WINS)服务状态  | 高       | 打开命令提示符，运行命令“services.msc”打开服务管理器<br/>停止显示名称为“Windows Internet Name Service (WINS)”或“WINS”的服务 |
| 检查Simple Mail Transport Protocol (SMTP)服务状态 | 高       | 打开命令提示符，运行命令“services.msc”打开服务管理器<br/>停止显示名称为“Simple Mail Transport Protocol (SMTP)”的服务 |
| 检查Remote Access Connection Manager服务状态      | 高       | 打开命令提示符，运行命令“services.msc”打开服务管理器<br/>停止显示名称为“Remote Access Connection Manager”的服务<br>在Windows2000、WindowsXP、Windows2003中，由于此服务在联网环境中较为重要，且无法停止，所以不检查 |
| 检查补丁包版本和系统版本                          | 中       | 从微软官方下载最新补丁包安装，或开启自动更新安装最新补丁包<br>WindowsXP最新补丁包为SP3<br>Windows2003和Windows2003R2最新补丁包为SP2<br/>WindowsVista和Windows2008为SP2<br/>Windows7和Windows2008R2为SP1 |
| 检查系统是否已安装最新高危补丁                    | 中       | 访问网页http://update.microsoft.com，按照提示安装补丁。      |
| 检查是否已安装防病毒软件                          | 中       | 安装防病毒软件，并及时更新病毒库                             |
| 检查可被缓存保存的登录的个数                      | 低       | 此项仅适用于域成员<br>打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\安全选项<br/>在右边窗格中找到“(交互式登录：)可被缓存保存的前次登录个数（在域控制器不可用的情况下）”或“交互式登录: 之前登录到缓存的次数(域控制器不可用时)”，配置为不大于标准值的值5 |
| 检查服务器在暂停会话前所需的空闲时间量            | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\安全选项<br/>在右边窗格中找到“(Microsoft 网络服务器: )暂停(挂起、断开)会话前所需的空闲时间量”，配置为标准值15 |
| 检查是否已对所有驱动器关闭Windows自动播放         | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\管理模板\Windows组件\自动播放策略<br>在右边窗格中找到“关闭/停用自动播放”，配置为“启用”，且选为对“所有驱动器”生效 |
| 检查当前Windows数据执行保护(DEP)等级              | 低       | 打开控制面板，打开“系统属性(高级系统设置)”<br>切换到“高级”选项卡下，点击“性能”中的“设置”按钮弹出“性能选项”对话框，切换到“数据执行保护”选项卡<br>勾选“仅为基本Windows程序和服务启用DEP” |
| 检查屏幕保护程序等待时间                          | 低       | 参考“检查是否已启用屏幕保护程序”，设置为不大于标准值30       |
| 检查是否已启用屏幕保护程序                        | 低       | 设置屏幕保护                                                 |
| 检查是否已启用“在恢复时显示登录界面”              | 低       | 设置为标准值1                                                |
| 检查是否已禁用Windows硬盘默认共享                 | 低       | 此项仅适用于非域环境<br>（1）打开命令提示符，运行命令“compmgmt.msc”打开计算机管理面板<br/>计算机管理(本地)\系统工具\共享文件夹\共享<br/>删除所有硬盘默认共享<br>（2）打开命令提示符，运行命令“regedit”打开注册表编辑器<br/>HKEY_LOCAL_MACHINE\System\CurrentControlSet\ Services\LanmanServer\Parameters\<br/>添加名称为“AutoShareServer和AutoShareWks”、类型为DWORD、数据为0，若已存在则修改其数据。注意：若关闭C盘默认共享(C$)，将不能使用BVS的SMB扫描。 |
| 检查共享文件夹的共享权限                          | 低       | 此项不适用于域控服务器<br>打开命令提示符，运行命令“compmgmt.msc”打开计算机管理面板<br>计算机管理(本地)\系统工具\共享文件夹\共享<br>查看每个自定义共享文件夹的共享权限，若其中包含“Everyone(任何人)”，则将其删除 |
| 检查是否已启用“不显示最后的用户名”策略            | 低       | 打开命令提示符，运行命令“gpedit.msc”打开组策略编辑器<br/>本地计算机策略\计算机配置\Windows设置\安全设置\本地策略\安全选项<br/>在右边窗格中找到“登录屏幕上不要显示上次登录的用户名“或”交互式登录: 不显示最后的用户名”，配置为“已启用” |

